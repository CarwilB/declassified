<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="">
<meta name="dcterms.date" content="1979-12-26">

<title>declassified - 1979 Bolivia Human Rights Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&amp;family=Courier+Prime:ital,wght@0,400;0,700;1,400&amp;family=Special+Elite&amp;display=swap" rel="stylesheet">


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">declassified</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cables/index.html"> 
<span class="menu-text">Cables</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">1979 Bolivia Human Rights Report</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Date</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 26, 1979</p>
    </div>
  </div>
  
    
  </div>
  


</header>


    <div class="cable-metadata-container">
      <table class="cable-table">
              <tbody><tr class="cable-row">
          <td class="cable-label-cell"><strong>Date:</strong></td>
          <td class="cable-value-cell">December 26, 1979</td>
        </tr>
                    <tr class="cable-row">
          <td class="cable-label-cell"><strong>From:</strong></td>
          <td class="cable-value-cell">SecState WashDC</td>
        </tr>
                    <tr class="cable-row">
          <td class="cable-label-cell"><strong>To:</strong></td>
          <td class="cable-value-cell">AmEmbassy La Paz</td>
        </tr>
                    <tr class="cable-row">
          <td class="cable-label-cell"><strong>Info:</strong></td>
          <td class="cable-value-cell">Oct-00 Ads-00 Ha-05 /020 R</td>
        </tr>
                    <tr class="cable-row">
          <td class="cable-label-cell"><strong>Subject:</strong></td>
          <td class="cable-value-cell">1979 Bolivia Human Rights Report</td>
        </tr>
                    <tr class="cable-row">
          <td class="cable-label-cell"><strong>TAGS:</strong></td>
          <td class="cable-value-cell">SHUM, BL</td>
        </tr>
                  </tbody></table>
    </div>
    <hr>
  
<section id="department-of-state-telegram" class="level1">
<h1>DEPARTMENT OF STATE TELEGRAM</h1>
<p><strong>UNCLASSIFIED</strong></p>
<p>Bolivia’s past political instability has been an impediment to economic and social progress and, therefore, at least partially responsible for the country’s uneven record in terms of human rights observance. In 1977 then President Banzer initiated a liberalization of virtually all major restrictions on human rights, releasing all reported political prisoners, allowing exiles to return, and scheduling elections for July 1978. This positive human rights momentum was not checked by the Pereda coup (August 1978) or the Padilla takeover (November 1978). While the first represented a brief interruption in the democratization process and the second was designed to put it back on track, both governments contributed to the improving human rights situation: General Pereda by abrogating the feared State Security Law, and General Padilla by overseeing in July 1979, possibly the most democratic elections in Bolivia’s history.</p>
<p>As none of the eight presidential hopefuls achieved the needed [majority] of the popular vote in the July 1979 elections, the issue went before the Congress where, similarly, none of the three leading candidates succeeded in obtaining [majority]. Finally, the Congress selected Senate President Walter Guevara Arze to serve as interim president with new elections scheduled for May 1980.</p>
<p>Guevara’s interim government came to an abrupt end November 1, 1979, when a group of military officers and civilians under the leadership of Army Colonel Alberto Natusch Busch seized the government. The Natusch government responded to strong popular reaction against the coup and its interruption of the democratic process with the implementation of press censorship, a state of siege, and martial law. Protesting but unarmed civilians were confronted by undisciplined soldiers resulting in the death of approximately 200 persons, the wounding of some 200 others, and the unaccounted for disappearance of about 125 citizens, many of whom are now presumed dead. Popular discontent, a seven-day strike by the Confederation of Bolivian Workers (COB), and Natusch’s repressive measures hastened the demise of his regime.</p>
<p>After Natusch’s resignation on November 16, an agreement was reached between the Congress, the COB, and the armed forces appointing Chamber of Deputies President Lidia Gueiler as interim president. President Guevara, who had become a resistance symbol in hiding during the Natusch regime, returned to his former Senate position. Ms.&nbsp;Gueiler is to be Bolivia’s interim president until the inauguration on August 6, 1980 of the winner of the 1980 elections, which will probably be held in June.</p>
<ol type="1">
<li><p><strong>Respect for the Integrity of the Person, Including Freedom From:</strong></p>
<p>A. <strong>Torture</strong></p>
<p>The Bolivian constitution prohibits torture and other forms of cruel, inhuman, or degrading treatment. The Padilla and Guevara administrations apparently respected this constitutional guarantee; there were no reports of torture during their brief governments – nor during the first weeks of President Gueiler’s administration. Allegations of torture during the short-lived Natusch regime remain unsubstantiated, but are currently being investigated by the Permanent Assembly on Human Rights (PAHR), Bolivia’s principal non-governmental organization promoting respect for human rights.</p>
<p>The Bolivian Congress also requested the PAHR on November 19 to document all cases of persons killed, wounded, or missing as a result of Natusch’s repressive measures. The findings are expected to be made public.</p>
<p>B. <strong>Cruel, Inhuman or Degrading Treatment or Punishment</strong></p>
<p>No reports of cruel, inhuman, or degrading treatment were received during the Padilla or Guevara governments nor during the first weeks of the Gueiler government. There are unsubstantiated allegations of beatings of political and labor leaders detained during the Natusch regime.</p>
<p>Although the Bolivian constitution prohibits cruel, inhuman or degrading treatment or punishment in all circumstances, PAHR representatives indicate that infractions occur. According to the PAHR, policemen sometimes beat persons accused of common crimes during interrogation to force confessions. Most such detainees do not file complaints, however, presumably either because they are unaware of their civil rights or because they fear reprisals. The PAHR believes that only a few police officials engage in such practices, and it is attempting to document cases of mistreatment so that offending policemen can be punished.</p>
<p>Most prisons in Bolivia are old and overcrowded. Sanitary conditions are poor, and prisoners’ diet is inadequate. These conditions result in part from Bolivia’s low level of economic development and associated poverty. Many prisoners, however, receive supplementary money, food, clothing and medicines from relatives or friends. Others manufacture smalls for outside contractors in exchange for money or food to supplement prison fare. Prisoners have no opportunity to become rehabilitated through learning job skills or improving their education while in prison. Prison officials recognize the problems in the present system, but indicate that lack of adequate funding precludes early improvement.</p>
<p>C. <strong>Arbitrary Arrest or Imprisonment</strong></p>
<p>The Padilla, Guevara, and Gueiler governments have not imprisoned persons for their political beliefs or activity. During the Natusch coup before press censorship was imposed, newspapers and the radio reported the arrest of several labor leaders and politicians in various parts of the country. These people were held only briefly. Additional reports of similar short-term detentions appeared in the press after censorship was lifted. There have also been reports that as many as 125 people disappeared during this two-week period, the majority of whom are unaccounted for. There were no known political prisoners in Bolivia at the end of November, 1979.</p>
<p>Persons are frequently arrested and held for brief periods without charge in Bolivia. Occasionally, especially in serious criminal cases, a suspect is held longer than the 24 hours stipulated in the constitution before being brought before a judge. This is probably due more to procedural delays than any attempt by the police to deny justice. Habeas corpus exists and is respected in practice.</p>
<p>D. <strong>Denial of Fair Public Trial</strong></p>
<p>Persons arrested in Bolivia are entitled by law to a fair public trial. However, the judicial process moves slowly, with some criminal cases taking years to complete because of inherent faults in the judicial system – antiquated procedures, shortage of qualified personnel, etc. Defendants may hire their own counsel, and may confer with them in private. Civil courts are independent of the military and civilians are not tried in military courts.</p>
<p>E. <strong>Invasion of the Home</strong></p>
<p>The sanctity of the home is constitutionally protected. There were no reports of invasions of the home during either the Padilla or Guevara governments nor were there during the first weeks of the Gueiler government. During the Natusch coup, however, illegal searches were made of the houses of some persons opposed to his takeover – mainly labor leaders and politicians – for weapons and for members of the Guevara “government in hiding”.</p></li>
<li><p><strong>Governmental Policies Relating to the Fulfillment of Such Vital Needs as Food, Shelter, Health Care and Education:</strong></p>
<p>Bolivia remains an underdeveloped country. Nevertheless, despite recurring serious macroeconomic problems, the government of Bolivia has succeeded in significantly improving the quality of life for the majority of its citizens. Since 1975, successive governments implemented a five-year Economic and Social Development Plan emphasizing a rapid growth, export-oriented strategy. The Plan’s original goals included improving national income distribution (an OAS study indicates that 5 percent of the Bolivian population controls 31 percent of the national income), incorporating the rural (mostly Indian) population into the modern life of the country, and improving overall welfare through education, health, and agricultural programs. While Bolivia’s worsening economic situation prevented the fulfillment of major elements of the plan, World Bank figures showed that by 1979 per capita GNP had reached $630 in 1977 dollars, up from $352 in 1960. The Gueiler government in its first weeks implemented an economic stabilization program, which, if well carried out, can provide the basis for resuming soundly-based long-term economic growth.</p>
<p>Average life expectancy is 52 years. The nationwide annual death rate is estimated at 18.5 per thousand and the infant mortality rate for children under one year of age in rural areas is 235 per thousand. These figures are partially the results of communicable, respiratory, and gastrointestinal diseases and malnutrition among the population. The health problems persist largely because of inadequate financing and direction to improve the quality and distribution of health services. Of the rural population, 11.2 percent lives in areas which have adequate sewage disposal; 12 percent have access to potable water.</p>
<p>An estimated 40 percent of the Bolivian population over the age of 15 is illiterate. In an effort to overcome this problem the government provides a free public education system through the university level. Unfortunately, rural poverty forces many children to neglect their studies in favor of working to help support their families. Also, school sessions are often interrupted by labor strife or political activity.</p>
<p>The lack of adequate housing is a serious problem. The majority of housing units in the major cities are substandard. Rural families typically live in adobe dwellings without basic sanitary facilities. The poor environmental conditions accompanying such housing exacerbate problems of sanitation, nutrition and other impediments to health.</p>
<p>Government programs to fulfill basic human needs are hampered primarily by the lack of financial, human, and material resources. Although there have been occasional reports of corruption in the administration of some of these programs, it does not appear that corruption has been a major factor impeding their effective implementation.</p></li>
<li><p><strong>Respect for Civil and Political Liberties, Including:</strong></p>
<p>A. <strong>Freedom of Speech, Press, Religion and Assembly</strong></p>
<p>Under the Padilla and Guevara governments, there were no reports of violations of any of these freedoms which are constitutionally guaranteed. Soon after assuming power, Colonel Natusch, however, imposed press censorship, a state of siege, curfew, and martial law. After a crippling seven-day general strike called by the COB, Natusch agreed to lift these measures in exchange for an end to the strike. The National Press Association (ANP), and the Vice President of the Bolivian Ecumenical Conference, among others, protested the press censorship and the silencing of several radio stations during the two-week military takeover. Before the Natusch coup, the press in Bolivia exercised a degree of “self-censorship”, ostensibly to avoid political controversy that could jeopardize the democratization process.</p>
<p>Freedom of speech, the press, and assembly were restored by the Gueiler government. There are no restrictions on religious freedom.</p>
<p>B. <strong>Freedom of Movement Within the Country, Foreign Travel and Emigration</strong></p>
<p>Freedom of movement, travel, and emigration is constitutionally protected although as a vestige of the MNR days of the 1950s Bolivians outside the country must apply at a Bolivian consulate for a visa to enter their own country. Only under the two-week Natusch regime were there any new restrictions on travel and these were eliminated when President Gueiler took office.</p>
<p>C. <strong>Freedom to Participate in the Political Process</strong></p>
<p>Political parties and labor unions have been able to operate freely since early 1978. In July 1979, eight political parties or coalitions participated in the general elections; none was the official party. Despite some allegations of electoral fraud by the contending parties and coalitions, it is generally accepted that the Electoral Court did its job well and that actual fraud in these elections was minor. All citizens 21 years of age and older may vote.</p>
<p>Traditionally, women have not enjoyed equal opportunity in Bolivia. However, this is changing. For example, before becoming interim president, Lidia Gueiler had been elected President of the Chamber of Deputies and awarded the Order of the Condor, Bolivia’s highest decoration, for her political activities. Two women presently serve in the Congress, and two in the cabinet. Indian women in both rural and urban areas continue to play a major role in the commercial sector and contribute substantially to family incomes.</p>
<p>Labor unions exercise considerable power in Bolivian society, as evidenced by the general strike in early November, 1979 which contributed to the demise of the Natusch regime. Trade unions profess to maintain neutrality among political parties. Individual union members, however, often actively participate in partisan political activities.</p></li>
<li><p><strong>Government Attitude and Record Regarding International and Non-Governmental Investigation of Alleged Violations of Human Rights:</strong></p>
<p>The Permanent Assembly on Human Rights (PAHR) is Bolivia’s principal non-governmental organization promoting respect for human rights. It maintains close contact with other international human rights organizations, whose members often travel to Bolivia for consultations on the state of human rights. The PAHR is working for the ratification of UN human rights agreements to which Bolivia is not yet a party.</p>
<p>Bolivia is the only Latin American country whose parliament has a human rights committee in each house. As part of its effort to improve human rights observance, Bolivia became a party to the American Convention on Human Rights in 1979.</p></li>
</ol>
<hr>
<section id="message-attributes" class="level4">
<h4 class="anchored" data-anchor-id="message-attributes">Message Attributes</h4>
<ul>
<li><p><strong>Document Number:</strong> 1979STATE331361</p></li>
<li><p><strong>Date:</strong> December 26, 1979</p></li>
<li><p><strong>Classification:</strong> UNCLASSIFIED</p></li>
<li><p><strong>Declassified:</strong> 01 jan 1960</p></li>
<li><p><strong>Concepts:</strong> HUMAN RIGHTS, REPORTS</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>