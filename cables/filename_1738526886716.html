<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stedman">
<meta name="dcterms.date" content="1974-09-06">

<title>declassified - Opic Insurance Operations In Bolivia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&amp;family=Courier+Prime:ital,wght@0,400;0,700;1,400&amp;family=Special+Elite&amp;display=swap" rel="stylesheet">


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">declassified</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cables/index.html"> 
<span class="menu-text">Cables</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/CarwilB/declassified">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/CarwilB/declassified/issues">
            Report Issue
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Opic Insurance Operations In Bolivia</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Stedman </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Date</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 6, 1974</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="department-of-state-telegram" class="level1">
<h1>DEPARTMENT OF STATE TELEGRAM</h1>
<p><strong>UNCLASSIFIED</strong></p>
    <div class="cable-metadata-container">
      <table class="cable-table">
              <tbody><tr class="cable-row">
          <td class="cable-label-cell"><strong>Date:</strong></td>
          <td class="cable-value-cell">September 06, 1974</td>
        </tr>
                    <tr class="cable-row">
          <td class="cable-label-cell"><strong>From:</strong></td>
          <td class="cable-value-cell">AmEmbassy La Paz</td>
        </tr>
                    <tr class="cable-row">
          <td class="cable-label-cell"><strong>To:</strong></td>
          <td class="cable-value-cell">SecState WashDC 4149</td>
        </tr>
                    <tr class="cable-row">
          <td class="cable-label-cell"><strong>Info:</strong></td>
          <td class="cable-value-cell">Oct-01 Ara-16 Iso-00 Eb-11 Come-00 Aid-20 L-03 Ciae-00 Inr-11 Nsae-00 Agr-20 Int-08 /102 W ——————— 054922 R 061930z Sep 74</td>
        </tr>
                    <tr class="cable-row">
          <td class="cable-label-cell"><strong>Subject:</strong></td>
          <td class="cable-value-cell">Opic Insurance Operations In Bolivia</td>
        </tr>
                    <tr class="cable-row">
          <td class="cable-label-cell"><strong>TAGS:</strong></td>
          <td class="cable-value-cell">EINV,BL</td>
        </tr>
                    <tr class="cable-row">
          <td class="cable-label-cell"><strong>Ref:</strong></td>
          <td class="cable-value-cell">LA PAZ 1972: LA PAZ 5513</td>
        </tr>
            </tbody></table>
    </div>
    <hr>
  
<ol type="1">
<li><p>MANSBACH’S VISIT WAS USEFUL TO US AS IT PROVIDED US WITH OPIC’S CURRENT THINKING ON ITS OPERATIONS IN BOLIVIA AND SOME ADDITIONAL INFORMATION ON SPECIFIC CASES.</p></li>
<li><p>IN A CONVERSATION WITH AMB STEDMAN AND ECOM OFFICERS, MANSBACH INDICATED THAT OPIC CURRENTLY WAS INTERESTED MAINLY IN LOAN AND LOAN INSURANCE OPERATIONS, AND ESPECIALLY WAS LIMITING ITSELF TO THESE OPERATIONS IN THE CASE OF FIRMS EXPORTING 80 PERCENT OF THEIR PRODUCTION TO THE ANDEAN MARKET AND THEREFORE RAISING THE DECISION 24, ARTICLE 51 SUBROGATION PROBLEM. MANSBACH INDICATED OPIC LAWYERS WERE CONSIDERING SOMEHOW SEPARATING OPIC INSURANCE CONTRACTS AND THE NECESSARY FGA’S FROM THEPROVISIONS OF ART. 51, YET PRESER- VING SUBROGATION RIGHTS UNDER THE BILATERAL AGREEMENTS. THIS MIGHT BE BASED ON INTERPRETING ART. 51 TO REFER ONLY TO GOVERNMENT “INSTRUMENTS RELATING TO INVESTMENT” WHILE MAINTAINING THAT OPIC INVESTMENT INSURANCE CONTRACTS ARE NOT OR WILL NOT BE GOVERNMENT INSTRUMENTS.MANSBACH SAID THAT OPIC MIGHT HIRE A LOCAL LAWYER TO LOOK INTO SUCH POSSIBILITIES. WE BELIEVE THAT OPIC CANNOT HAVE IT BOTH WAYS. IF IT IS A PRIVATE INSURANCE COMPANY, THEN ITS RIGHTS SHOULD NOT BE SUBROGATED TO USG, EXCEPT PERHAPS BY THE PROCESSES OF STATE DEPT. ESPOUSAL OF PRIVATE CLAIMS. WE DOUBT,</p></li>
</ol>
<p>062118Z</p>
<p>HOWEVER, THAT THE ANDEAN PACT COMMISSION OR GOB WILL AGREE THAT</p>
<p>ART. 51 REFERS ONLY TO GOVERNMENT INVESTMENT INSTRUMENTS IF THEY ARE AWARE THAT THE “PRIVATE” INSURER INTENDS TO AVAIL ITSELF OF THE BENEFITS OF A GOVERNMENT TO GOVERNMENT BILATERAL TREATY.</p>
<ol start="3" type="1">
<li><p>MANSBACH INDICATED THAT OPIC PLANS TO INSURE LOAN OR LOANS TO NEW JERSEY ZINC (NJZ), A SUBSIDIARY OF GULF AND WESTERN, PERHAPS SUPPLEMENTED BY A DIRECT OPIC LOAN AND DIRECT INVESTMENT INSURANCE IN CONCERT WITH A JAPANESE INVESTMENT IN THE MIXED COMPANY NJZ SEEKS TO FORM. WE RECALLED THAT IN LA PAZ 2284 WE WARNED THAT THE EMBASSY MIGHT RECOMMEND AGAINST INSURANCE FOR NJZ. WE STATD USG SHOULD HAVE BIAS AGAINST INSURING INVESTMENTS IN SENSITIVE MINING SECTOR AND THAT WE DID NOT HAVE SUFFICIENT INFO ON NJZ PLANS TO PROPERLY EVALUATE SITUATION. IT APPEARED TO US THAT NJZ HAD MADE ITS MOVES TO BUY GIBRALTAR HUARI-HUARI BEFORE IT COULD HAVE BEEN ASSURRED OF HAVING OPIC INSURANCE, ESPECIALLY IN VIEW OF THE PARA- GRAPH OPIC PUT IN ITS REGISTRATION NOTICE OF APRIL 2, 1974 WHICH PLACES NJZ PROJECT UNDER “LARGE AND SENSITIVE POLICY GUIDELINES” AND WARNS NJZ THAT ISSUES SHOULD BE DISCUSSED WITH OPIC AND RESOLVED BEFORE IT PROCEEDS TO INVEST OR COMMIT THE PREDOMINANT PART OF ITS PROPOSED INVESTMENT. WE REPORTED IN LA PAZ 1972 THAT NJZ HAD PAID IMPC/GIBRALTAR HUARI-HUARI DEBTS TO BANCO MINERO TOTALLING US$ 240,000 BEFORE MARCH 28, 1974. IT APPEARS THAT NJZ’S INTEREST WAS SO GREAT THAT IT MADE THIS PAYMENT ON OR BEFORE THE DATE OF ITS REQUEST FOR OPIC INSURANCE. REPORTEDLY NJZ ALREADY HAS INVESTED AT LEAST US$ 1.4 MILLION AND PERHAPS AS MUCH AS US$ 4.4 MILLION IN ITS GIBRALTAR HUARI-HUARI PROJECT. IT SEEMS LIKELY, THEREF ORE, THAT OPIC INSURANCE IS NOT ESSENTIAL TO NJZ DECISION TO GO AHEAD WITH THIS PROJECT.</p></li>
<li><p>IN RESPONSE TO THESE VIEWS, MANSBACH SAID “ADDITONALITY” NOT ALWAYS ESSENTIAL AND THAT OPIC NEEDS TO SPREAD ITS RISKS IN SOME CASES TO SOUND INVESTMENTS THAT MAY NOT BE “ADDITIONAL” DUE TO THE OPIC INSURANCE INCENTIVE. WE BELIEVE THAT BOLIVIAN MINING SECTOR IS ONE OF LAST PLACES OPIC SHOULD LOOK FOR DIVERSIFYING INTO SOUND INVESTMENTS. WE SUSPECT NJZ INVESTMENT WILL BE ECONOMICALLY SOUND, BUT POLITICALLY RISKY.</p></li>
<li><p>GULF AND WESTERN ALSO OWNS, THROUGH ITS SUBSIDIARY BROWN &amp; CO., KELLGUANI MINE. TOGETHER WITH GIBALTAR HUARI-HUARI, GULF AND</p></li>
</ol>
<p>062118Z</p>
<p>WESTERN COULD RAPIDLY BECOME BIGGEST AND MOST VISIBLE PRIVATE MINING INTEREST IN BOLIVIA.</p>
<ol start="6" type="1">
<li><p>MINOR POINT IS THAT IMPC/GIBRALTAR HUARI-HUARI HAS ALREADY INVESTED US$ 1.2 MILLION ORE MORE. OPIC WOULD HAVE TO BE QUITE CLEAR ON EXACLY WHAT IT WOULD BE COVERING.</p></li>
<li><p>GIVEN ALL THESE CONSIDERATIONS, WE BELIEVE IT IS IN USG</p></li>
</ol>
<p>INTEREST TO OPPOSE OPIC INSURANCE FOR NJZ, AT LEAST UNTIL DETAILED INFORMATION MADE AVAILABLE TO EMBASSY. CAREFUL DECISION CAN THEN BE MADE ON BASIS SUCH INFORMATION.</p>
<ol start="8" type="1">
<li><p>MATTER OF INVESTMENTS IN AGRICULTURAL LAND WAS RAISED BY STATE 185136 DURING MANSBACH’S VISIT. AS EMBASSY HAD NOT RECEIVED RESPONSE TO EARLIER MESSAGES ON STOKES APPLICATION (AS WELL AS TO SOME OTHER APPLICATIONS), WE SENT LA PAZ 5513 OPPOSING INSURANCE FOR STOKES AT LEAST UNTIL ISSUES RESOLVED. EMBASSY CONSIDERS AGRICULTURAL LAND TO BE SECTOR AS SENSITIVE AS MINING IN VIEW LONG STANDING AGRARIAN REFORM POLICIES AND UNRESOLVED LAND INVESTMENT DISPUTE (APPLEGATE/ YOUNGUIST CASE). WHILE THIS GOVERNMENT HAS DONE NOTHING TO EXTEND REACH OF AGRARIAN REFORM, IT HAS ALLOWED COFADENA (MILITARY CORPORA- TION) TO TAKE OVER CAMPO LUMINOSA, ONE OF BOLIVIA’S LARGEST CATTLE RANCHES WHICH HAD OVERDUE DEBTS WITH BANCO DEL ESTADO. AS POPULATION PRESSURE MOUNTS IN SANTA CRUZ, CHAPARE BENI AND NORTHERN LA PAZ, WE EXPECT FURTHER EXTENSION AGRARIAN REFORM WILL BECOME BURNING POLITI- CAL ISSUE WHICH ALMOST ANY PROSPECTIVE GOVERNMENT LIKELY TO RESOLVE TO SOME EXTENT IN FAVOR OF BOLIVIAN SMALL FARMER AT EXPENSE OF LARGE FOREIGN FARMER. MOREOVER, AS WE HAVE NOTED PREVIOUSLY, LAND TITLE EVEN AMONG LARGE DEVELOPERS APPARENTLY MATTER OF CONTINUAL DISPUTE. MANSBACH ASKED EMBASSY TO CONSIDER MATTER CAREFULLY TO DECIDE WHETHER WE WISHED RAISE OBJECTIONS TO INVESTMENTS IN AGRICULTURAL LAND ON POLITICAL GROUNDS.</p></li>
<li><p>AFTER CONSIDERATION OF OPIC POSITIONS IN GENERAL ON SIGNIFICIANCE OF REGISTRATION NOTES, SUBROGATION AND INVOLVEMENT OF OTHER USG PROGRAMS IN EFFORTS ARRANGE PAYMENTS TO OPIC INSURED FIRMS IN NATIONALIZA- TION CASES, AS WELL AS RECENT EXPERIENCE WITH HANDLING APPLICATIONS COVERING MINING AND AGRICULTURAL LAND INVESTMENTS, WE CONFIRM OUR EARLIER POSITION THAT THERE SHOULD BE A STRONG BIAS AGAINST INSURING SUCH INVESTMENTS IN BOLIVIA, BUT WE STILL DO NOT WISH TO CLOSE THE</p></li>
</ol>
<p>062118Z</p>
<p>DOOR COMPLETELY. AS MAJORITY OF “BOLIVIAN” APPLICATION TO OPIC APPEAR TO BE TWO MOST SENSITIVE AREAS AND AS OPIC PROCEDURES NOW RESULT IN ALMOST IMMEDIAT AND AUTOMATIC ISSUANCE OF REGISTRA- TION NOTICE AND AS OPIC BENDS EVERY EFFORT TO GRANT INSURANCE ONCE REGISTRATION NOTICE ISSUED, WE BELIEVE BEST PROCEDURE TO MEET OUR POLITICAL AND PROGRAM CONCERNS IN SENSITIVE AREAS, DEFINED AS MINING AND AGRICULTURAL LAND, WOULD BE ALONG FOLLOWING LINES: 1) OPIC WOULD ADVISE APPLICANT THAT REGISTRATION NOTICE CANNOT BE ISSUED UNTIL DETAILED INVESTMENT PROPOSAL PRESENTED TO OPIC AND OPIC CAN CONSULT WITHIN USG: 2) EMBASSY SHOULD BE PROVIDED WITH THESE DETAILS AND ALLOWED TO MAKE RECOMMENDATION BEFORE REGISTRA- TION NOTICE ISSUED: 3) IF INVESTOR ALTERS APROJECT, EMBASSY SHOULD BE ADVISED SO RECOMMENDATION CAN BE REVIEWED.</p>
<p>10.EMBASSY FULLY REALIZES THAT OPIC CAN DEAL WITH MANY PROBLEMS</p>
<p>BY CAREFUL DRAFTING INSURANCE CONTRACT, BUT SUCH ADJUSTMENT MAY NOT BE SUFFICIENT IN SOME CASES. WE BELIEVE BEST INTERESTS USG WILL BE SERVED BY GIVING MOST CAREFUL, CAUTIOUS AND BROAD CONSIDER- ATION TO INSURING U.S. INVESTMENTS IN SENSITIVE AREAS RATHER THAN EMPHASIZING OVERCOMING (PERHAPS ONLY SUPERFICIALLY) ANY OBSTACLES THAT APPEAR AND OBJECTIONS THAT MIGHT BE RAISED. STEDMAN</p>
<hr>
<section id="message-attributes" class="level4">
<h4 class="anchored" data-anchor-id="message-attributes">Message Attributes</h4>
<ul>
<li><p><strong>Document Number:</strong> 1974LAPAZ05806</p></li>
<li><p><strong>Date:</strong> September 06, 1974</p></li>
<li><p><strong>Classification:</strong> UNCLASSIFIED</p></li>
<li><p><strong>Declassified:</strong> 01 JAN 1960</p></li>
<li><p><strong>Concepts:</strong> AGREEMENTS, ZINC, INVESTORS, LOAN INSURANCE, FOREIGN INVESTMENTS, CONTRACTS, SUBSIDIARIES, FOREIGN POLICY</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>